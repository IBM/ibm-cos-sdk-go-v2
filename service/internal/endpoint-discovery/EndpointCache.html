<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Struct: endpoint-discovery.EndpointCache
  
    &mdash; IBM COS SDK for Go
  
</title>

  <link rel="stylesheet" href="../../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../../css/common.css" type="text/css" />

  <link rel="stylesheet" href="../../../css/highlight.github.css" type="text/css" />

<script type="text/javascript">
  pathId = "service/internal/endpoint-discovery.EndpointCache";
  relpath = '../../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../../package_list.html"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../../_index.html">Index (E)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../../service.html" title="service (package)">service</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../internal.html" title="internal (package)">internal</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../endpoint-discovery.html" title="endpoint-discovery (package)">endpoint-discovery</a></span></span>
     &raquo; 
    <span class="title">EndpointCache</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="package_list_link"
        href="../../../package_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <iframe id="search_frame"></iframe>

      <div id="content">
        <!--REGION_DISCLAIMER_DO_NOT_REMOVE-->
        <h1>Struct: endpoint-discovery.EndpointCache
  
  
  
</h1>
<div class="package signature">
import "../ibm-cos-sdk-go-v2/service/internal/endpoint-discovery"
</div>
<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>EndpointCache is an LRU cache that holds a series of endpoints based on some key. The data structure makes use of a read write mutex to enable asynchronous use.</p>


  </div>
</div>
<div class="tags">
  

</div>

  <h3 class="inherited">Implemented Interfaces</h3>
  <p class="inherited"><span class='object_link'><a href="../../s3/types/AnalyticsFilter.html" title="types.AnalyticsFilter (interface)">types.AnalyticsFilter</a></span>, <span class='object_link'><a href="../../../aws/signer/v4/HTTPPresigner.html" title="v4.HTTPPresigner (interface)">v4.HTTPPresigner</a></span>, <span class='object_link'><a href="../../s3/HTTPPresignerV4.html" title="s3.HTTPPresignerV4 (interface)">s3.HTTPPresignerV4</a></span>, <span class='object_link'><a href="../../s3/types/MetricsFilter.html" title="types.MetricsFilter (interface)">types.MetricsFilter</a></span>, <span class='object_link'><a href="../../s3/PresignPost.html" title="s3.PresignPost (interface)">s3.PresignPost</a></span>, <span class='object_link'><a href="../s3shared/arn/S3ObjectLambdaARN.html" title="arn.S3ObjectLambdaARN (interface)">arn.S3ObjectLambdaARN</a></span>, <span class='object_link'><a href="../../s3/types/SelectObjectContentEventStream.html" title="types.SelectObjectContentEventStream (interface)">types.SelectObjectContentEventStream</a></span></p>


  

  









  
    <h2>
      Constructor Functions
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        
<li class="public ">
  <span class="summary_signature"><span class='object_link'><a href="#NewEndpointCache-class_method" title="endpoint-discovery.EndpointCache.NewEndpointCache() (method)">func <strong>NewEndpointCache</strong>(endpointLimit int64) *EndpointCache </a></span></span>
  
  
  
  
  
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>NewEndpointCache will return a newly initialized cache with a limit of endpointLimit entries.</p>
</div></span>
  
</li>


      
    </ul>
  
    <h2>
      Method  Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        
<li class="public ">
  <span class="summary_signature"><span class='object_link'><a href="#Add-instance_method" title="endpoint-discovery.EndpointCache.Add() (method)">func (c *EndpointCache) <strong>Add</strong>(endpoint Endpoint) </a></span></span>
  
  
  
  
  
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Add is a concurrent safe operation that will allow new endpoints to be added to the cache.</p>
</div></span>
  
</li>


      
        
<li class="public ">
  <span class="summary_signature"><span class='object_link'><a href="#Get-instance_method" title="endpoint-discovery.EndpointCache.Get() (method)">func (c *EndpointCache) <strong>Get</strong>(endpointKey string) (WeightedAddress, bool) </a></span></span>
  
  
  
  
  
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Get will retrieve a weighted address based off of the endpoint key.</p>
</div></span>
  
</li>


      
        
<li class="public ">
  <span class="summary_signature"><span class='object_link'><a href="#Has-instance_method" title="endpoint-discovery.EndpointCache.Has() (method)">func (c *EndpointCache) <strong>Has</strong>(endpointKey string) bool </a></span></span>
  
  
  
  
  
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Has returns if the enpoint cache contains a valid entry for the endpoint key provided.</p>
</div></span>
  
</li>


      
    </ul>
  





  <div id="Function_method_details" class="method_details_list">
    <h2>Function Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="NewEndpointCache-class_method">
  
    func <strong><span class='object_link'><a href="#NewEndpointCache-class_method" title="endpoint-discovery.EndpointCache.NewEndpointCache() (method)">NewEndpointCache</a></span></strong>(endpointLimit int64) *<span class='object_link'><a href="" title="endpoint-discovery.EndpointCache (struct)">EndpointCache</a></span> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>NewEndpointCache will return a newly initialized cache with a limit of endpointLimit entries.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


21
22
23
24
25
26</pre>
    </td>
    <td>
      <pre class="code"><span class="info file">// File 'service/internal/endpoint-discovery/cache.go', line 21</span>

<div class="hljs"><span class="hljs-keyword">func</span> NewEndpointCache(endpointLimit <span class="hljs-constant">int64</span>) *EndpointCache {
	<span class="hljs-keyword">return</span> &EndpointCache{
		endpointLimit: endpointLimit,
		endpoints:     sync.Map{},
	}
}</div></pre>
    </td>
  </tr>
</table>

</div>
    
  </div>

  <div id="Method_method_details" class="method_details_list">
    <h2>Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="Add-instance_method">
  
    func (c *<span class='object_link'><a href="" title="endpoint-discovery.EndpointCache (struct)">EndpointCache</a></span>) <strong><span class='object_link'><a href="#Add-instance_method" title="endpoint-discovery.EndpointCache.Add() (method)">Add</a></span></strong>(endpoint <span class='object_link'><a href="Endpoint.html" title="endpoint-discovery.Endpoint (struct)">Endpoint</a></span>) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Add is a concurrent safe operation that will allow new endpoints to be added to the cache. If the cache is full, the number of endpoints equal endpointLimit, then this will remove the oldest entry before adding the new endpoint.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81</pre>
    </td>
    <td>
      <pre class="code"><span class="info file">// File 'service/internal/endpoint-discovery/cache.go', line 66</span>

<div class="hljs"><span class="hljs-keyword">func</span> (c *EndpointCache) Add(endpo<span class="hljs-constant">int</span> Endpo<span class="hljs-constant">int</span>) {
	<span class="hljs-comment">// de-dups multiple adds of an endpoint with a pre-existing key</span>
	<span class="hljs-keyword">if</span> iface, ok := c.endpoints.Load(endpo<span class="hljs-constant">int</span>.Key); ok {
		e := iface.(Endpo<span class="hljs-constant">int</span>)
		<span class="hljs-keyword">if</span> e.Len() > 0 {
			<span class="hljs-keyword">return</span>
		}
	}

	size := atomic.AddInt64(&c.size, 1)
	<span class="hljs-keyword">if</span> size > 0 && size > c.endpointLimit {
		c.deleteRandomKey()
	}

	c.endpoints.Store(endpo<span class="hljs-constant">int</span>.Key, endpo<span class="hljs-constant">int</span>)
}</div></pre>
    </td>
  </tr>
</table>

</div>
    
      <div class="method_details ">
  <h3 class="signature " id="Get-instance_method">
  
    func (c *<span class='object_link'><a href="" title="endpoint-discovery.EndpointCache (struct)">EndpointCache</a></span>) <strong><span class='object_link'><a href="#Get-instance_method" title="endpoint-discovery.EndpointCache.Get() (method)">Get</a></span></strong>(endpointKey string) (<span class='object_link'><a href="WeightedAddress.html" title="endpoint-discovery.WeightedAddress (struct)">WeightedAddress</a></span>, bool) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Get will retrieve a weighted address based off of the endpoint key. If an endpoint should be retrieved, due to not existing or the current endpoint has expired the Discoverer object that was passed in will attempt to discover a new endpoint and add that to the cache.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


55
56
57
58
59
60
61</pre>
    </td>
    <td>
      <pre class="code"><span class="info file">// File 'service/internal/endpoint-discovery/cache.go', line 55</span>

<div class="hljs"><span class="hljs-keyword">func</span> (c *EndpointCache) Get(endpointKey <span class="hljs-constant">string</span>) (WeightedAddress, <span class="hljs-constant">bool</span>) {
	endpo<span class="hljs-constant">int</span>, ok := c.get(endpointKey)
	<span class="hljs-keyword">if</span> !ok {
		<span class="hljs-keyword">return</span> WeightedAddress{}, <span class="hljs-constant">false</span>
	}
	<span class="hljs-keyword">return</span> endpo<span class="hljs-constant">int</span>.GetValidAddress()
}</div></pre>
    </td>
  </tr>
</table>

</div>
    
      <div class="method_details ">
  <h3 class="signature " id="Has-instance_method">
  
    func (c *<span class='object_link'><a href="" title="endpoint-discovery.EndpointCache (struct)">EndpointCache</a></span>) <strong><span class='object_link'><a href="#Has-instance_method" title="endpoint-discovery.EndpointCache.Has() (method)">Has</a></span></strong>(endpointKey string) bool 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Has returns if the enpoint cache contains a valid entry for the endpoint key provided.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


46
47
48
49</pre>
    </td>
    <td>
      <pre class="code"><span class="info file">// File 'service/internal/endpoint-discovery/cache.go', line 46</span>

<div class="hljs"><span class="hljs-keyword">func</span> (c *EndpointCache) Has(endpointKey <span class="hljs-constant">string</span>) <span class="hljs-constant">bool</span> {
	_, found := c.Get(endpointKey)
	<span class="hljs-keyword">return</span> found
}</div></pre>
    </td>
  </tr>
</table>

</div>
    
  </div>


      </div>

      <div id="footer">
  Generated on Mon Jan 12 07:21:00 2026 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.38 (ruby-3.1.2).
</div>

<!-- BEGIN-SECTION -->
<script type="text/javascript" src="https://media.amazonwebservices.com/amznUrchin.js"></script>
<!-- SiteCatalyst code version: H.25.2. Copyright 1996-2012 Adobe, Inc. All Rights Reserved.
More info available at http://www.omniture.com -->
<script language="JavaScript" type="text/javascript" src="https://media.amazonwebservices.com/js/sitecatalyst/s_code.min.js">
</script>
<script language="JavaScript" type="text/javascript">
  <!--
  s.prop66='AWS SDK for Go';
  s.eVar66='D=c66';
  s.prop65='API Reference';
  s.eVar65='D=c65';
  var s_code=s.t();if(s_code)document.write(s_code)
  //-->
</script>
<script language="JavaScript" type="text/javascript">
  <!--if(navigator.appVersion.indexOf('MSIE')>=0)document.write(unescape('%3C')+'\!-'+'-')
  //-->
</script>
<noscript>
  <img src="http://amazonwebservices.d2.sc.omtrdc.net/b/ss/awsamazondev/1/H.25.2--NS/0" height="1" width="1" border="0" alt="">
</noscript>
<!--/DO NOT REMOVE/-->
<!-- End SiteCatalyst code version: H.25.2. -->
<!-- END-SECTION -->

    </div>
  </body>
</html>
